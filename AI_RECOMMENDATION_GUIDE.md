# 🤖 AI 메뉴 추천 시스템 가이드

## 개요

LunchSelector의 AI 추천 시스템은 **사용자 행동 패턴 분석 기반**의 개인화된 메뉴 추천을 제공합니다. 진정한 머신러닝 AI가 아닌 **규칙 기반 추천 엔진**이지만, 다양한 데이터 포인트를 종합해서 정확한 추천을 제공합니다.

---

## 🎯 추천 알고리즘 (3가지 전략 조합)

AI 추천은 다음 3가지 전략을 **조합**해서 메뉴를 추천합니다. 각 전략의 가중치는 다음과 같습니다:

```
🎯 최종 추천 점수 =
  (카테고리 기반 40점) +
  (새로운 메뉴 35점) +
  (시간대 기반 25점)
```

---

## 📊 1️⃣ 카테고리 기반 추천 (40%)

### 개념
사용자가 **과거에 자주 선택한 카테고리**를 분석하여 같은 카테고리의 메뉴를 추천합니다.

### 동작 방식

```javascript
// 사용자 선택 이력 분석
categoryPreferences = {
  '한식': 5,     // 5번 선택
  '중식': 3,     // 3번 선택
  '일식': 1      // 1번 선택
}

// 추천 확률
선호도 높은 카테고리: 70% (한식 → 3.5개 추천)
다른 카테고리: 30% (중식, 일식 등 → 1.5개 추천)
```

### 코드 위치
- `recommendationManager.js:115-162` - `recommendByCategory()` 함수

---

## 🆕 2️⃣ 새로운 메뉴 추천 (35%)

### 개념
사용자가 **아직 먹어본 적 없는 메뉴**를 점수로 평가해서 추천합니다. 다양성을 제공하면서도 사용자 선호도를 반영합니다.

### 점수 계산 요소

```javascript
메뉴별 점수 = (요소1 × 가중치1) + (요소2 × 가중치2) + ...

1. 선호 카테고리 가산점: +10점
   → 사용자가 자주 선택한 카테고리의 메뉴일 경우

2. 검색 패턴 유사도: +5점
   → 과거 검색어와 유사한 메뉴명

3. 준비시간 효율: +20점
   → 준비시간 15분 이내 (점심시간에 도움)

4. 영양점수 우수: +15점
   → 영양점수 70점 이상
```

### 예시 계산

```
메뉴: 갈비탕 (한식)
- 한식 선호도 높음: +40점 (5번 선택 × 10)
- 검색어 "국" 유사도: +3점
- 준비시간 25분: 0점
- 영양점수 78점: +15점
━━━━━━━━━━━━━━━
최종 점수: 58점

메뉴: 미역국 (한식)
- 한식 선호도 높음: +40점
- 검색어 "국" 유사도: +4점
- 준비시간 10분: +20점
- 영양점수 82점: +15점
━━━━━━━━━━━━━━━
최종 점수: 79점 ⭐ (더 높은 추천도)
```

### 코드 위치
- `recommendationManager.js:170-224` - `recommendNewMenus()` 함수
- `recommendationManager.js:232-265` - 문자열 유사도 계산

---

## ⏰ 3️⃣ 시간대 기반 추천 (25%)

### 개념
**현재 시간대에 맞는 메뉴**를 추천합니다. 점심시간에는 빠른 음식을 우선적으로 추천합니다.

### 시간대별 전략

```javascript
// 점심시간 (11:00 ~ 13:00)
→ 준비시간 20분 이내의 빠른 음식 우선
→ 선호도와 영양점수로 2차 정렬
→ 이유: 제한된 점심시간 고려

// 아침 (06:00 ~ 11:00)
→ 일반 카테고리 기반 추천

// 저녁 (18:00 ~ 20:00)
→ 일반 카테고리 기반 추천

// 야식 (20:00 ~ 23:00)
→ 일반 카테고리 기반 추천
```

### 코드 위치
- `recommendationManager.js:273-320` - `recommendByTimeOfDay()` 함수
- `recommendationManager.js:101-107` - `getTimeSlot()` 함수

---

## 👤 사용자 프로필 분석

### 수집 데이터

```javascript
profile = {
  // 1. 카테고리별 선택 빈도
  categoryPreferences: {
    '한식': 5,
    '중식': 3
  },

  // 2. 메뉴별 선택 빈도
  menuPreferences: {
    '한식_갈비탕': 2,
    '한식_김치찌개': 1
  },

  // 3. 최근 검색어 (상위 10개)
  searchPatterns: ['국', '국물', '빠른음식', ...],

  // 4. 선택 이력 (최근 20개)
  viewHistory: [
    { category: '한식', menu: '갈비탕', timestamp: ... },
    ...
  ],

  // 5. 시간대별 선택 패턴
  timePatterns: {
    '점심': 8회,
    '저녁': 3회,
    '아침': 1회
  },

  // 6. 사용자 설정
  preferences: {
    // 향후 확장용
  }
}
```

### 코드 위치
- `recommendationManager.js:39-94` - `buildUserProfile()` 함수

---

## 🔄 학습 및 피드백 시스템

### 피드백 수집

사용자가 추천받은 메뉴를 평가하면 다음 추천에 반영됩니다:

```javascript
// 사용자 평가 (1-5점)
💬 "갈비탕 - 5점 ⭐⭐⭐⭐⭐"

// 시스템 저장
{
  timestamp: 1234567890,
  category: '한식',
  menu: '갈비탕',
  rating: 5
}
```

### 피드백 활용

```javascript
// 다음 추천 생성 시
→ 평가 점수가 높은 메뉴 → 앞으로 자주 추천
→ 평가 점수가 낮은 메뉴 → 앞으로 덜 추천
→ 사용자 만족도 향상
```

### 코드 위치
- `recommendationManager.js:437-458` - `recordRecommendationFeedback()` 함수
- `recommendationManager.js:464-500` - `getRecommendationStats()` 함수

---

## 📈 통계 및 성과 추적

### 제공되는 통계

```javascript
stats = {
  // 평균 만족도 (1.0 ~ 5.0)
  avgRating: 4.2,

  // 평점별 분포
  byRating: {
    5: 10,  // 5점 평가 10개
    4: 8,   // 4점 평가 8개
    3: 4,   // 3점 평가 4개
    2: 1,   // 2점 평가 1개
    1: 0    // 1점 평가 0개
  },

  // 총 피드백 개수
  totalFeedback: 23
}
```

### UI 표시 위치
- AI 추천 패널 → 📊 통계 탭
- 평균 만족도 바그래프
- 평점 분포 히스토그램

---

## 🔧 종합 AI 추천 프로세스

### 단계별 진행

```
1️⃣ 사용자 프로필 생성
   ↓
2️⃣ 3가지 추천 전략 실행
   ├─ 카테고리 기반 추천 (40%)
   ├─ 새로운 메뉴 추천 (35%)
   └─ 시간대 기반 추천 (25%)
   ↓
3️⃣ 종합 점수로 정렬
   (각 전략의 점수 합산)
   ↓
4️⃣ 상위 5개 메뉴 반환
   ↓
5️⃣ 추천 이력 저장
   ↓
6️⃣ UI에 표시
```

### 코드 위치
- `recommendationManager.js:328-367` - `generateAIRecommendations()` 함수

---

## 💾 데이터 저장소

### localStorage 사용

```javascript
// 1. 메뉴 선택 이력
lunch_selector_viewed_menus = [
  { category: '한식', menu: '갈비탕', timestamp: ... },
  ...
]

// 2. 추천 이력 (최대 30개)
lunch_selector_recommendation_history = [
  { timestamp: ..., recommendations: [...] },
  ...
]

// 3. 추천 피드백 (최대 100개)
lunch_selector_recommendation_feedback = [
  { timestamp: ..., category: '한식', menu: '갈비탕', rating: 5 },
  ...
]

// 4. 사용자 설정
lunch_selector_user_preferences = { ... }
```

---

## 🚀 사용 방법

### 1. AI 추천 패널 열기
```
메인 페이지 상단 → 💡 AI 추천 버튼 클릭
```

### 2. 추천 확인
```
🥇 1위: 갈비탕 (한식) - 점수: 100점
🥈 2위: 미역국 (한식) - 점수: 95점
🥉 3위: 김치찌개 (한식) - 점수: 85점
```

### 3. 메뉴 선택
```
"선택" 버튼 → 해당 메뉴 선택 기록 저장
```

### 4. 피드백 제공
```
"💬" 버튼 → 1-5점 평가 → 통계에 반영
```

### 5. 통계 확인
```
📊 통계 탭 → 평균 만족도, 평점 분포 확인
```

---

## 📝 제한사항

### 현재 구현의 한계

```
❌ 진정한 머신러닝 미사용
   → 규칙 기반 추천만 지원

❌ 사용자 간 협업 필터링 미지원
   → 개별 사용자 데이터만 사용

❌ 선호도 학습의 자동 가중치 조정 미지원
   → 고정된 가중치만 사용

❌ 복잡한 사용자 세그먼트 분석 미지원
   → 단순 카테고리/메뉴 수준
```

### 향후 개선 방향

```
✅ 딥러닝 기반 실제 AI 모델 도입
✅ 사용자 간 패턴 학습 (협업 필터링)
✅ 자동 가중치 최적화
✅ 영양정보, 가격, 선호도 복합 분석
✅ 계절/날씨 기반 추천
✅ 사용자 그룹 기반 추천
```

---

## 🔗 관련 파일

| 파일 | 역할 |
|------|------|
| `recommendationManager.js` | AI 추천 알고리즘 핵심 로직 |
| `RecommendationPanel.jsx` | UI 컴포넌트 |
| `RecommendationPanel.css` | 스타일시트 |
| `menuDetailManager.js` | 메뉴 상세정보 제공 |
| `searchManager.js` | 검색 패턴 저장 |

---

## 📞 문제 해결

### Q: 추천이 정확하지 않아요
**A:** 더 많은 메뉴를 선택하고 피드백을 제공하면 추천 정확도가 향상됩니다. 최소 5-10개의 선택 기록이 필요합니다.

### Q: 왜 같은 메뉴만 추천해요?
**A:** "새로운 메뉴 추천" 전략은 아직 선택하지 않은 메뉴만 추천합니다. 자주 선택하는 카테고리의 다른 메뉴를 선택하면 다양한 추천을 받을 수 있습니다.

### Q: 시간대 기반 추천이 안 보여요?
**A:** 현재 시간이 점심시간(11:00-13:00)이 아니면 일반 카테고리 기반 추천만 제공됩니다. 점심시간에 사용하면 빠른 음식 중심 추천을 받을 수 있습니다.

---

**마지막 업데이트**: 2024년 10월 23일
**개발자**: LunchSelector Team
